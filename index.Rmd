---
title: "Testovoe"
author: Alex
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: readable
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
```

### My first chart

```{r}
aisc2024 <- read_csv("aisc2024.csv")
```
```{r}
library(ggplot2)
library(ggrepel)

aisc2024 |> 
  ggplot(
    aes(
      x = tempo,
      y = arousal,
      size = instrumentalness,
      colour = danceability
    )
  ) +
  geom_point(alpha = 0.8, stroke = 0.2) +   # Increase alpha for visibility, add stroke for contrast
  geom_rug(linewidth = 0.2, sides = "b") + # Keep rug only at the bottom
  geom_text_repel(  # Better placement of text labels
    aes(label = ifelse(tempo > 120 & arousal > 4, "Onda Corta - Sud America", "")),
    size = 4,
    fontface = "bold",
    color = "black",  # Make labels stand out
    nudge_x = 10, 
    nudge_y = 0.5,
    box.padding = 0.4,
    point.padding = 0.4,
    segment.color = "gray50", # Subtle connector lines
    max.overlaps = 1 # Prevents duplicate labels
  ) +
  scale_x_continuous(         
    limits = c(50, 200),
    breaks = seq(50, 200, 50), 
    minor_breaks = NULL
  ) +
  scale_y_continuous(         
    limits = c(1, 9),
    breaks = c(1, 5, 9),
    minor_breaks = NULL
  ) +
  scale_colour_viridis_c(option = "C") +  # A more visually appealing Viridis color scale
  scale_size_continuous(      
    trans = "sqrt", 
    guide = "none"
  ) +
  theme_minimal(base_size = 14) +  
  theme(
    legend.position = "right",
    axis.title = element_text(size = 14, face = "bold"),
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    panel.grid.major = element_line(size = 0.3, linetype = "dashed"), # Subtle gridlines
    panel.grid.minor = element_blank()
  ) +
  labs(                       
    title = "Music Characteristics: Tempo vs Arousal",
    x = "Tempo (BPM)",
    y = "Arousal Level",
    colour = "Danceability"
  )
ggplotly()
```

